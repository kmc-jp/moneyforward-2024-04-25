# HTTP client

このプログラムは、Go 言語を使用した HTTP クライアントです。

HTTP は、Web サーバーとクライアント間でデータを送受信するためのプロトコルです。
Google Chrome や Safari などの Web ブラウザは、HTTP を使用して Web サーバーと通信します。
HTTP を使用して Web サーバーからデータを取得するプログラムを HTTP クライアントと呼びます。

実際の Web ページは、HTML や CSS、JavaScript などの言語で記述されています。
ブラウザは、これらの言語を解釈して Web ページを画面上に表示します。
この表示のためにはレンダリングエンジンというものが必要です。

ここで作成する HTTP クライアントは、あくまで Web サーバからデータを取得するためだけのプログラムです。
レンダリングエンジンを持っていないため、Web ページを画面に表示することができません。
あくまでその元となる、HTML などの言語で書かれたソースコードをダウンロードする機能だけを持ちます。

## 事前準備

このプログラムを実行する前に、マシンに Go がインストールされていることを確認してください。
Go をダウンロードしてインストールするには、[公式ウェブサイト](https://golang.org/) を参照してください。

code-server を使用している場合は、Go がデフォルトでインストールされているため、この手順は不要です。

## プログラムを実行する

プログラムを実行するには、次の手順に従ってください：

1. ターミナルを開きます
1. `main.go` ファイルがあるディレクトリに移動します

```bash
cd ~/work/basic/http_client
```

3. 次のコマンドを実行します：

```bash
go run main.go
```

これで、コンソールに `https://www.kmc.gr.jp/` のソースコードが表示されます。

一般的な Web ブラウザは、このソースコードを解釈して画面に表示します。
しかし、このプログラムは、ソースコードをそのまま表示するだけです。

## コードの説明

`http.Get()` という関数は、指定された URL に HTTP リクエストを送信し、結果をダウンロードします。

もし何かエラーがあった場合は、`panic()` 関数を使用してプログラムを停止します。
実際のアプリケーションでは、エラーを適切に処理する必要がありますが、このプログラムでは簡略化のために省略しています。
「適切な処理」とは、たとえば再度リクエストを送信する、ユーザーにやさしいエラーメッセージを表示する、などのことです。

`defer` で始まる行は、処理の後始末を行うためのものです。
これをやらないと、PC のリソースが枯渇することがあるので注意が必要です。

とはいえ、このプログラムはすぐに終了するものなので、忘れていてもあまり困ることはありません。
長時間起動し続けるプログラムでは、忘れないようにしましょう。

`io.ReadAll()` という関数は、HTTP リクエストからのデータを読み取ります。

最後に、`fmt.Println()` 関数を使用して、取得したデータをコンソールに表示します。

### ありそうな質問

#### Q: `import` の行で `fmt` や `io` などが書かれていますが、この順番に意味はありますか？

ありません。

自動で ABC 順に並べ替えられているだけです。

#### Q: `err` に値が入るのは、どういうシチュエーションでしょうか？

`http.Get(url)` がエラーを返す場合では、以下のような理由が考えられます。

- あたえられた URL が間違っている
- インターネットに接続できていない
- サーバーがダウンしている

#### Q: `err` を確認する必要があまりよく分かりませんが、なぜ必要なのでしょうか？

エラーを無視して処理を継続しても良いのですが、それを無視してしまうと、その後の処理でまた問題になるからです。
エラーが発生した場合は、できるだけ早く処理を止めることで、エラーが発生した原因を特定しやすくなります。

## 演習

いろいろ改造してみましょう。

### プログラムの引数を使用してアクセスする URL を指定する

Go プログラムは、コマンドライン引数を受け取ることができます。
コマンドライン引数を使用して、プログラムが表示するテキストを指定できるようにしてみましょう。

`os.Args` という変数に、コマンドライン引数にセットされた値が入っています。
複数の引数がある場合もすべて `os.Args` の中に入っています。

ひとつめの引数を取得する場合は `os.Args[1]` と書きます。

この変更を行なった上で、`go run main.go https://www.kyoto-u.ac.jp/` というコマンドを実行してみましょう。
これで、`https://www.kyoto-u.ac.jp/` のソースコードが表示されるはずです。

また、`go run main.go https://www.google.com/` であれば、`https://www.google.com/` のソースコードが表示されるはずです。

#### コマンドライン引数とは

コマンドライン引数とは、プログラムを起動するときに、追加の情報や指示をプログラムに伝えるために使われる特別な言葉や数字のことです。
これは、プログラムが動き始める前に、ユーザーがプログラムに対して特定のタスクを実行するように指示する方法の一つです。

例えば、スマートフォンのアプリを考えてみましょう。
アプリをタップすると、そのアプリは普通の状態で起動します。
しかし、もしアプリが「コマンドライン引数」を受け取ることができたら、アプリを開く前に特定の機能をすぐに実行するように指示することができるでしょう。
具体的には、電話アプリを起動してから画面で電話番号を入力するかわりに、架電したい電話番号をコマンドライン引数として渡すことで、すぐに電話をかけることができるようになります。

要するに、コマンドライン引数はプログラムに対して「こうしてほしい」というお願いをするための手段なのです。
